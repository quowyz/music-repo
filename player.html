<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>æˆ‘çš„éŸ³ä¹æ’­æ”¾å™¨</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 20px;
      background: #f4f4f9;
    }
    .player {
      max-width: 400px;
      margin: auto;
      background: white;
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    img {
      width: 200px;
      height: 200px;
      border-radius: 12px;
      object-fit: cover;
      transition: opacity 0.6s ease-in-out; /* æ·¡å…¥æ·¡å‡º */
    }
    .controls {
      margin: 15px 0;
    }
    .controls button {
      background: linear-gradient(135deg, #6a11cb, #2575fc);
      border: none;
      color: white;
      padding: 10px 18px;
      margin: 5px;
      border-radius: 25px;
      font-size: 16px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .controls button:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .playlist {
      display: grid;
      grid-template-columns: 1fr 1fr; /* ä¸¤æ å¸ƒå±€ */
      gap: 8px;
      margin-top: 10px;
    }
    .playlist div {
      background: #f9f9f9;
      padding: 6px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .playlist div:hover {
      background: #e6f0ff;
    }
    .active {
      background: #cce0ff !important;
      font-weight: bold;
    }
    .mode {
      margin-top: 10px;
      font-size: 14px;
      color: #444;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>ğŸ¶ æˆ‘çš„éŸ³ä¹æ’­æ”¾å™¨ ğŸ¶</h2>
  <div class="player">
    <img id="cover" src="images/1.jpg" alt="å°é¢">
    <div class="controls">
      <button onclick="prevSong()">â® ä¸Šä¸€é¦–</button>
      <button onclick="togglePlay()">â–¶ï¸/â¸ æ’­æ”¾</button>
      <button onclick="nextSong()">â­ ä¸‹ä¸€é¦–</button>
    </div>
    <div id="mode" class="mode" onclick="switchMode()">ğŸ” å¾ªç¯æ’­æ”¾</div>
    <div class="playlist" id="playlist"></div>
  </div>

  <audio id="audio" preload="auto"></audio>

  <script>
    const songs = [
      { title: "æ­Œæ›² 1", src: "music/1.mp3", cover: "images/1.jpg" },
      { title: "æ­Œæ›² 2", src: "music/2.mp3", cover: "images/2.jpg" },
      { title: "æ­Œæ›² 3", src: "music/3.mp3", cover: "images/3.jpg" },
      { title: "æ­Œæ›² 4", src: "music/4.mp3", cover: "images/4.jpg" },
    ];

    let currentIndex = 0;
    let mode = "loop"; // loop / random
    const audio = document.getElementById("audio");
    const cover = document.getElementById("cover");
    const playlistEl = document.getElementById("playlist");

    // æ¸²æŸ“æ’­æ”¾åˆ—è¡¨
    function renderPlaylist() {
      playlistEl.innerHTML = "";
      songs.forEach((song, i) => {
        const div = document.createElement("div");
        div.textContent = song.title;
        div.className = (i === currentIndex) ? "active" : "";
        div.onclick = () => playSong(i);
        playlistEl.appendChild(div);
      });
    }

    // åˆ‡æ¢æ­Œæ›²å¹¶æ·¡å…¥æ·¡å‡º
    function playSong(index) {
      currentIndex = index;
      const song = songs[currentIndex];
      audio.src = song.src;

      // å°é¢æ·¡å‡ºå†æ¢å›¾
      cover.style.opacity = 0;
      setTimeout(() => {
        cover.src = song.cover;
        cover.style.opacity = 1;
      }, 300);

      audio.play();
      renderPlaylist();

      // ä¸Šä¼ æ’­æ”¾é‡
      fetch(`https://api.countapi.xyz/hit/my-music-player/${encodeURIComponent(song.title)}`);
    }

    function togglePlay() {
      if (audio.paused) {
        audio.play();
      } else {
        audio.pause();
      }
    }

    function prevSong() {
      if (mode === "random") {
        playSong(Math.floor(Math.random() * songs.length));
      } else {
        playSong((currentIndex - 1 + songs.length) % songs.length);
      }
    }

    function nextSong() {
      if (mode === "random") {
        playSong(Math.floor(Math.random() * songs.length));
      } else {
        playSong((currentIndex + 1) % songs.length);
      }
    }

    function switchMode() {
      mode = (mode === "loop") ? "random" : "loop";
      document.getElementById("mode").textContent =
        mode === "loop" ? "ğŸ” å¾ªç¯æ’­æ”¾" : "ğŸ”€ éšæœºæ’­æ”¾";
    }

    // è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–
    audio.onended = nextSong;

    // åˆå§‹åŒ–
    renderPlaylist();
    playSong(0);
  </script>
</body>
</html>
